<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserve Your View | Falcamel Café</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'DIN Pro';
            src: url('DINPro-Regular.ttf') format('truetype');
            font-weight: 400;
        }
        @font-face {
            font-family: 'DIN Pro';
            src: url('DINPro-Medium.ttf') format('truetype');
            font-weight: 500;
        }
        @font-face {
            font-family: 'DIN Pro';
            src: url('DINPro-Bold.ttf') format('truetype');
            font-weight: 700;
        }

        :root {
            --sand: #E8DCC4;
            --sandstone: #C4A574;
            --terracotta: #B8634C;
            --deep-burgundy: #6B2D3C;
            --night: #1A1614;
            --gold: #D4A853;
            --cream: #FAF6F0;
            --cream-dark: #F0EBE3;
            --success: #4a7c59;
            --error: #B8634C;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'DIN Pro', sans-serif;
            background: url('hero.jpg') center top / cover no-repeat fixed;
            color: var(--night);
            line-height: 1.6;
            min-height: 100vh;
        }

        h1, h2, h3 { font-family: 'Libre Baskerville', serif; font-weight: 400; }

        .page { min-height: 100vh; padding: 1.5rem 2rem 3rem; }

        .booking-card {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(250, 246, 240, 0.97);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            padding: 1.5rem 2.5rem 2.5rem;
        }

        .booking-header { margin-bottom: 1.25rem; }
        .booking-header h1 { font-size: 2.25rem; color: var(--deep-burgundy); }

        .section { margin-bottom: 1rem; }
        .section-label {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--terracotta);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .date-pills { display: flex; gap: 0.5rem; overflow-x: auto; padding-bottom: 0.5rem; }
        .date-pill {
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 0.875rem;
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            background: transparent;
            color: var(--night);
            cursor: pointer;
            transition: all 0.15s;
            min-width: 60px;
        }
        .date-pill:hover { border-color: var(--deep-burgundy); }
        .date-pill.selected { background: var(--deep-burgundy); border-color: var(--deep-burgundy); color: var(--cream); }
        .date-pill .day { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.7; }
        .date-pill .num { font-size: 1.125rem; font-weight: 700; }
        .date-pill.selected .day { opacity: 1; }
        .date-pill svg { width: 18px; height: 18px; }

        .calendar-dropdown { position: relative; }
        .calendar-panel {
            display: none;
            position: absolute;
            top: 0.5rem;
            left: 0;
            background: var(--cream);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            padding: 1rem;
            z-index: 100;
            min-width: 280px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .calendar-panel.open { display: block; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .calendar-month { font-weight: 600; font-size: 0.9rem; }
        .calendar-nav { display: flex; gap: 0.25rem; }
        .calendar-nav button {
            width: 28px; height: 28px;
            background: var(--cream-dark);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            cursor: pointer;
        }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; text-align: center; }
        .calendar-weekday { font-size: 0.6rem; font-weight: 500; color: var(--terracotta); text-transform: uppercase; padding: 0.5rem 0; }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            border-radius: 4px;
            cursor: pointer;
        }
        .calendar-day:hover:not(.empty):not(.past) { background: var(--cream-dark); }
        .calendar-day.past { opacity: 0.3; cursor: not-allowed; }
        .calendar-day.selected { background: var(--deep-burgundy); color: var(--cream); font-weight: 600; }
        .calendar-day.today { border: 1px solid var(--terracotta); }

        .time-grid { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .time-slot {
            padding: 0.5rem 0.875rem;
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            background: transparent;
            color: var(--night);
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.15s;
        }
        .time-slot:hover { border-color: var(--deep-burgundy); }
        .time-slot.selected { background: var(--deep-burgundy); border-color: var(--deep-burgundy); color: var(--cream); }

        .duration-grid { display: flex; gap: 0.5rem; }
        .duration-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            background: transparent;
            color: var(--night);
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.15s;
        }
        .duration-btn:hover { border-color: var(--deep-burgundy); }
        .duration-btn.selected { background: var(--deep-burgundy); border-color: var(--deep-burgundy); color: var(--cream); }
        .duration-note { margin-top: 0.5rem; font-size: 0.75rem; color: var(--terracotta); }

        .companion-section { display: none; }
        .companion-section.visible { display: block; }
        .companion-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
        @media (max-width: 700px) { .companion-grid { grid-template-columns: 1fr; } }

        .companion-card {
            background: var(--cream-dark);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            padding: 1.25rem;
            transition: all 0.15s;
        }
        .companion-card:hover:not(.unavailable) { border-color: var(--deep-burgundy); }
        .companion-card.unavailable { opacity: 0.5; cursor: not-allowed; }
        .companion-card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem; }
        .companion-name { font-family: 'Libre Baskerville', serif; font-size: 1.25rem; color: var(--deep-burgundy); }
        .companion-badge {
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0.25rem 0.5rem;
            border-radius: 2px;
        }
        .companion-badge.available { background: rgba(74, 124, 89, 0.15); color: var(--success); }
        .companion-badge.booked { background: rgba(184, 99, 76, 0.15); color: var(--error); }
        .companion-tagline { font-size: 0.85rem; font-style: italic; color: var(--night); opacity: 0.8; margin-bottom: 0.75rem; }
        .companion-features { display: flex; flex-wrap: wrap; gap: 0.375rem; margin-bottom: 0.75rem; }
        .companion-feature {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            background: rgba(196, 165, 116, 0.3);
            border-radius: 2px;
            color: var(--night);
        }
        .companion-footer { display: flex; justify-content: space-between; align-items: center; }
        .companion-price { font-family: 'DIN Pro', sans-serif; }
        .companion-price strong { font-size: 1.125rem; font-weight: 700; color: var(--deep-burgundy); }
        .companion-price span { font-size: 0.8rem; color: var(--terracotta); }
        .book-btn {
            padding: 0.5rem 1rem;
            background: var(--deep-burgundy);
            color: var(--cream);
            border: none;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }
        .book-btn:hover { background: var(--terracotta); }

        .full-package {
            margin-top: 1rem;
            padding: 1.25rem;
            background: var(--deep-burgundy);
            border-radius: 4px;
            color: var(--cream);
            display: none;
        }
        .full-package.visible { display: block; }
        .full-package-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem; }
        .full-package h3 { font-size: 1.25rem; color: var(--gold); }
        .full-package-badge {
            font-size: 0.6rem;
            font-weight: 700;
            text-transform: uppercase;
            padding: 0.25rem 0.5rem;
            border-radius: 100px;
        }
        .full-package-badge.available { background: rgba(74, 124, 89, 0.3); color: #7ed99a; }
        .full-package-subtitle { font-size: 0.875rem; opacity: 0.8; margin-bottom: 0.75rem; }
        .full-package-footer { display: flex; justify-content: space-between; align-items: center; padding-top: 0.75rem; border-top: 1px solid rgba(250,246,240,0.2); }
        .full-package-price { font-size: 1.5rem; font-weight: 700; }
        .full-package-price span { font-size: 0.8rem; font-weight: 400; opacity: 0.7; }
        .full-package-btn {
            padding: 0.625rem 1.25rem;
            background: var(--gold);
            color: var(--night);
            border: none;
            border-radius: 4px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
        }
        .full-package-btn:hover { background: var(--cream); }

        .footer {
            max-width: 1000px;
            margin: 1.5rem auto 0;
            text-align: center;
            font-size: 0.75rem;
            color: var(--cream);
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        .footer a { color: var(--gold); text-decoration: none; }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(26, 22, 20, 0.9);
            z-index: 1000;
            overflow-y: auto;
            padding: 1.5rem 2rem 3rem;
            display: none;
        }
        .modal {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--cream);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            padding: 1.5rem 2.5rem 2.5rem;
            position: relative;
        }
        .modal-close {
            position: absolute; top: 1.5rem; right: 1.5rem;
            background: none;
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            color: var(--terracotta);
            font-size: 1.25rem;
            width: 40px; height: 40px;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }
        .modal-close:hover { border-color: var(--deep-burgundy); color: var(--deep-burgundy); }
        .modal-header { margin-bottom: 1.25rem; }
        .modal-header h1 { font-size: 2rem; color: var(--deep-burgundy); }
        .modal-section {
            background: var(--cream-dark);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }
        .modal-section-title { font-family: 'Libre Baskerville', serif; font-size: 1.125rem; color: var(--deep-burgundy); margin-bottom: 0.75rem; }
        .summary-row { display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 0.375rem; }
        .summary-row span:first-child { color: var(--terracotta); }
        .summary-row.total { padding-top: 0.75rem; margin-top: 0.5rem; border-top: 1px solid var(--sandstone); font-weight: 600; }
        .summary-row.total span:last-child { color: var(--deep-burgundy); font-size: 1.125rem; }
        .included-details { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--sandstone); }
        .included-title { font-size: 0.8rem; color: var(--terracotta); margin-bottom: 0.5rem; }
        .included-details ul { list-style: none; font-size: 0.8rem; color: var(--night); }
        .included-details li { margin-bottom: 0.25rem; }
        .included-details li::before { content: '✓ '; color: var(--success); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-field { margin-bottom: 0.875rem; }
        .form-field label { display: block; font-size: 0.8rem; color: var(--terracotta); margin-bottom: 0.375rem; }
        .form-field input {
            width: 100%;
            padding: 0.625rem 0.875rem;
            background: var(--cream);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            font-size: 0.9rem;
            color: var(--night);
        }
        .form-field input:focus { outline: none; border-color: var(--deep-burgundy); }
        .section-subtitle { font-size: 0.8rem; color: var(--terracotta); margin-bottom: 0.5rem; }
        .occasion-pills { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .occasion-pill {
            padding: 0.4rem 0.875rem;
            background: var(--cream);
            border: 1px solid var(--sandstone);
            border-radius: 100px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.15s;
        }
        .occasion-pill:hover { border-color: var(--deep-burgundy); }
        .occasion-pill.selected { background: var(--deep-burgundy); border-color: var(--deep-burgundy); color: var(--cream); }
        .notes-field {
            width: 100%;
            min-height: 80px;
            padding: 0.625rem 0.875rem;
            background: var(--cream);
            border: 1px solid var(--sandstone);
            border-radius: 4px;
            font-size: 0.9rem;
            font-family: inherit;
            resize: vertical;
        }
        .notes-field:focus { outline: none; border-color: var(--deep-burgundy); }
        .complete-btn {
            width: 100%;
            padding: 0.875rem;
            background: var(--deep-burgundy);
            color: var(--cream);
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }
        .complete-btn:hover { background: var(--terracotta); }
    </style>
</head>
<body>
    <div class="page">
        <div class="booking-card">
            <div class="booking-header">
                <h1>Reserve Your View</h1>
            </div>

            <div class="section">
                <div class="section-label">Select Date</div>
                <div class="date-pills" id="datePills"></div>
                <div class="calendar-dropdown">
                    <div class="calendar-panel" id="calendarPanel">
                        <div class="calendar-header">
                            <span class="calendar-month" id="calendarMonth">January 2026</span>
                            <div class="calendar-nav">
                                <button onclick="prevMonth()">‹</button>
                                <button onclick="nextMonth()">›</button>
                            </div>
                        </div>
                        <div class="calendar-grid" id="calendarGrid"></div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-label">Start Time</div>
                <div class="time-grid" id="timeGrid"></div>
            </div>

            <div class="section">
                <div class="section-label">Duration</div>
                <div class="duration-grid" id="durationGrid"></div>
                <div class="duration-note">Maximum 4 hours per reservation</div>
            </div>

            <div class="section companion-section" id="companionSection">
                <div class="section-label">Choose Your Companion</div>
                <div class="companion-grid">
                    <div class="companion-card" data-companion="sultan" data-base-price="350">
                        <div class="companion-card-header">
                            <span class="companion-name">Sultan</span>
                            <span class="companion-badge available">Available</span>
                        </div>
                        <p class="companion-tagline">Sultan arrives with his falconer, perches at your table unhooded. Photography encouraged.</p>
                        <div class="companion-features">
                            <span class="companion-feature">12 seats</span>
                            <span class="companion-feature">Falcon Flight</span>
                            <span class="companion-feature">2 beverages</span>
                            <span class="companion-feature">Falconer</span>
                            <span class="companion-feature">Photo session</span>
                        </div>
                        <div class="companion-footer">
                            <span class="companion-price"><strong>SAR 350</strong> <span>/ hour</span></span>
                            <button class="book-btn" onclick="bookCompanion('sultan')">Book Now</button>
                        </div>
                    </div>

                    <div class="companion-card" data-companion="haboob" data-base-price="250">
                        <div class="companion-card-header">
                            <span class="companion-name">Haboob</span>
                            <span class="companion-badge available">Available</span>
                        </div>
                        <p class="companion-tagline">Haboob stations himself at your terrace majlis. His milk is in your latte. His judgment is in his eyes.</p>
                        <div class="companion-features">
                            <span class="companion-feature">8 seats</span>
                            <span class="companion-feature">Camel Ride</span>
                            <span class="companion-feature">2 beverages</span>
                            <span class="companion-feature">Camel milk latte</span>
                            <span class="companion-feature">Photo ops</span>
                        </div>
                        <div class="companion-footer">
                            <span class="companion-price"><strong>SAR 250</strong> <span>/ hour</span></span>
                            <button class="book-btn" onclick="bookCompanion('haboob')">Book Now</button>
                        </div>
                    </div>

                    <div class="companion-card" data-companion="shams" data-base-price="150">
                        <div class="companion-card-header">
                            <span class="companion-name">Shams</span>
                            <span class="companion-badge available">Available</span>
                        </div>
                        <p class="companion-tagline">Shams roams your majlis area. He may acknowledge you. He may not. That's the gamble.</p>
                        <div class="companion-features">
                            <span class="companion-feature">8 seats</span>
                            <span class="companion-feature">2 beverages</span>
                            <span class="companion-feature">Zero guarantees</span>
                        </div>
                        <div class="companion-footer">
                            <span class="companion-price"><strong>SAR 150</strong> <span>/ hour</span></span>
                            <button class="book-btn" onclick="bookCompanion('shams')">Book Now</button>
                        </div>
                    </div>

                    <div class="companion-card" data-companion="qamar" data-base-price="150">
                        <div class="companion-card-header">
                            <span class="companion-name">Qamar</span>
                            <span class="companion-badge available">Available</span>
                        </div>
                        <p class="companion-tagline">Qamar favors sunset visitors. Book the golden hour slot and she'll find you. Lap time is her love language.</p>
                        <div class="companion-features">
                            <span class="companion-feature">8 seats</span>
                            <span class="companion-feature">2 beverages</span>
                            <span class="companion-feature">Sunset priority</span>
                        </div>
                        <div class="companion-footer">
                            <span class="companion-price"><strong>SAR 150</strong> <span>/ hour</span></span>
                            <button class="book-btn" onclick="bookCompanion('qamar')">Book Now</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="full-package" id="fullPackage">
                <div class="full-package-header">
                    <h3>The Full Falcamel</h3>
                    <span class="full-package-badge available">Available</span>
                </div>
                <p class="full-package-subtitle">Once per evening · Premium sunset slot · Binoculars & live race feed · Falconer commentary · Full qahwa service · All residents · Photo & video package</p>
                <div class="full-package-footer">
                    <span class="full-package-price">SAR 1,000 <span>/ evening</span></span>
                    <button class="full-package-btn" onclick="bookFullPackage()">Reserve The Full Falcamel →</button>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>Falcamel Café · Tuwaiq Escarpment, Qiddiya · Open 4 PM – 2 AM – 2 AM · Powered by <a href="#">OSKAR</a></p>
        </footer>

        <div class="modal-overlay" id="confirmModal">
            <div class="modal">
                <button class="modal-close" onclick="closeModal()">✕</button>
                <div class="modal-header"><h1>Complete Your Reservation</h1></div>
                
                <div class="modal-section">
                    <h2 class="modal-section-title">Reservation Details</h2>
                    <div class="summary-row"><span>Companion</span><span id="summaryCompanion">Sultan</span></div>
                    <div class="summary-row"><span>Date</span><span id="summaryDate">Sat, Jan 4</span></div>
                    <div class="summary-row"><span>Time</span><span id="summaryTime">6 PM</span></div>
                    <div class="summary-row"><span>Duration</span><span id="summaryDuration">2 hours</span></div>
                    <div class="summary-row total"><span>Total</span><span id="summaryTotal">SAR 700</span></div>
                    <div class="included-details">
                        <p class="included-title">What's included:</p>
                        <ul id="includedList"></ul>
                    </div>
                </div>

                <div class="modal-section">
                    <h2 class="modal-section-title">Guest Information</h2>
                    <div class="form-row">
                        <div class="form-field"><label>First Name</label><input type="text" placeholder="First name"></div>
                        <div class="form-field"><label>Last Name</label><input type="text" placeholder="Last name"></div>
                    </div>
                    <div class="form-field"><label>Email</label><input type="email" placeholder="email@example.com"></div>
                    <div class="form-field"><label>Phone</label><input type="tel" placeholder="+966 XX XXX XXXX"></div>
                </div>

                <div class="modal-section">
                    <h2 class="modal-section-title">Special Occasion</h2>
                    <p class="section-subtitle">Celebrating something?</p>
                    <div class="occasion-pills">
                        <button class="occasion-pill selected" onclick="selectOccasion(this)">None</button>
                        <button class="occasion-pill" onclick="selectOccasion(this)">Birthday</button>
                        <button class="occasion-pill" onclick="selectOccasion(this)">Anniversary</button>
                        <button class="occasion-pill" onclick="selectOccasion(this)">Date Night</button>
                        <button class="occasion-pill" onclick="selectOccasion(this)">Proposal</button>
                        <button class="occasion-pill" onclick="selectOccasion(this)">Business</button>
                        <button class="occasion-pill" onclick="selectOccasion(this)">Other</button>
                    </div>
                </div>

                <div class="modal-section">
                    <h2 class="modal-section-title">Additional Notes</h2>
                    <textarea class="notes-field" placeholder="Any special requests?"></textarea>
                </div>

                <button class="complete-btn" onclick="completeReservation()">Complete Reservation</button>
            </div>
        </div>
    </div>

    <script>
        let selectedDate = null, selectedTime = null, selectedTimeHour = null, selectedDuration = 1, currentMonth = new Date();

        const companionInfo = {
            sultan: { name: "Sultan", basePrice: 350, included: ["12 seats", "Falcon Flight", "2 beverages", "Falconer", "Photo session", "Edge seating"] },
            haboob: { name: "Haboob", basePrice: 250, included: ["8 seats", "Camel Ride", "2 beverages", "Camel milk latte", "Photo ops", "Edge seating"] },
            shams: { name: "Shams", basePrice: 150, included: ["8 seats", "2 beverages", "Zero guarantees", "Edge seating"] },
            qamar: { name: "Qamar", basePrice: 150, included: ["8 seats", "2 beverages", "Sunset priority", "Edge seating"] },
            fullpackage: { name: "The Full Falcamel", basePrice: 1000, included: ["Premium sunset slot", "Binoculars & live race feed", "Falconer commentary", "Full qahwa service", "All residents", "Photo & video package"] }
        };

        function generateDatePills() {
            const container = document.getElementById('datePills');
            const today = new Date();
            const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            
            const calPill = document.createElement('button');
            calPill.className = 'date-pill';
            calPill.innerHTML = '<span class="day">Calendar</span><span class="num"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></span>';
            calPill.onclick = () => document.getElementById('calendarPanel').classList.toggle('open');
            container.appendChild(calPill);

            for (let i = 0; i < 10; i++) {
                const date = new Date(today); date.setDate(today.getDate() + i);
                const pill = document.createElement('button');
                pill.className = 'date-pill';
                pill.innerHTML = '<span class="day">' + days[date.getDay()] + '</span><span class="num">' + date.getDate() + '</span>';
                pill.onclick = () => selectDate(date, pill);
                container.appendChild(pill);
            }
        }

        function selectDate(date, pill) {
            selectedDate = date;
            document.querySelectorAll('.date-pill').forEach(p => p.classList.remove('selected'));
            if (pill) pill.classList.add('selected');
            renderCalendar();
            checkShowCompanions();
        }

        function renderCalendar() {
            const grid = document.getElementById('calendarGrid'), monthLabel = document.getElementById('calendarMonth');
            const year = currentMonth.getFullYear(), month = currentMonth.getMonth();
            const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
            monthLabel.textContent = months[month] + ' ' + year;
            const firstDay = new Date(year, month, 1).getDay(), daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date(); today.setHours(0,0,0,0);
            let html = ['Su','Mo','Tu','We','Th','Fr','Sa'].map(d => '<div class="calendar-weekday">' + d + '</div>').join('');
            for (let i = 0; i < firstDay; i++) html += '<div class="calendar-day empty"></div>';
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const isPast = date < today, isToday = date.getTime() === today.getTime();
                const isSelected = selectedDate && date.getDate() === selectedDate.getDate() && date.getMonth() === selectedDate.getMonth() && date.getFullYear() === selectedDate.getFullYear();
                let cls = 'calendar-day'; if (isPast) cls += ' past'; if (isToday) cls += ' today'; if (isSelected) cls += ' selected';
                html += '<div class="' + cls + '" onclick="selectCalendarDay(' + day + ',' + month + ',' + year + ')">' + day + '</div>';
            }
            grid.innerHTML = html;
        }

        function selectCalendarDay(day, month, year) {
            const date = new Date(year, month, day), today = new Date(); today.setHours(0,0,0,0);
            if (date < today) return;
            selectDate(date);
            document.getElementById('calendarPanel').classList.remove('open');
        }

        function prevMonth() { currentMonth.setMonth(currentMonth.getMonth() - 1); renderCalendar(); }
        function nextMonth() { currentMonth.setMonth(currentMonth.getMonth() + 1); renderCalendar(); }

        function generateTimeSlots() {
            const grid = document.getElementById('timeGrid');
            const times = [{t:'4 PM',h:16},{t:'5 PM',h:17},{t:'6 PM',h:18},{t:'7 PM',h:19},{t:'8 PM',h:20},{t:'9 PM',h:21},{t:'10 PM',h:22},{t:'11 PM',h:23},{t:'12 AM',h:24},{t:'1 AM',h:25}];
            grid.innerHTML = times.map(t => '<button class="time-slot" onclick="selectTime(this,\'' + t.t + '\',' + t.h + ')">' + t.t + '</button>').join('');
        }

        function selectTime(el, time, hour) {
            selectedTime = time; selectedTimeHour = hour;
            document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
            el.classList.add('selected');
            checkShowCompanions();
        }

        function generateDuration() {
            const grid = document.getElementById('durationGrid');
            grid.innerHTML = [1,2,3,4].map(d => '<button class="duration-btn' + (d===1?' selected':'') + '" onclick="selectDuration(this,' + d + ')">' + d + ' hour' + (d>1?'s':'') + '</button>').join('');
        }

        function selectDuration(el, hours) {
            selectedDuration = hours;
            document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('selected'));
            el.classList.add('selected');
            checkShowCompanions();
        }

        function checkShowCompanions() {
            const section = document.getElementById('companionSection'), pkg = document.getElementById('fullPackage');
            if (selectedDate && selectedTime && selectedDuration) {
                section.classList.add('visible'); pkg.classList.add('visible');
                updatePrices();
            } else {
                section.classList.remove('visible'); pkg.classList.remove('visible');
            }
        }

        function updatePrices() {
            document.querySelectorAll('.companion-card').forEach(card => {
                const base = parseInt(card.dataset.basePrice), total = base * selectedDuration;
                card.querySelector('.companion-price strong').textContent = 'SAR ' + total;
                card.querySelector('.companion-price span').textContent = selectedDuration > 1 ? '/ ' + selectedDuration + ' hours' : '/ hour';
            });
        }

        function bookCompanion(id) {
            const info = companionInfo[id], total = info.basePrice * selectedDuration;
            const dateStr = selectedDate.toLocaleDateString('en-US', {weekday:'short',month:'short',day:'numeric'});
            document.getElementById('summaryCompanion').textContent = info.name;
            document.getElementById('summaryDate').textContent = dateStr;
            document.getElementById('summaryTime').textContent = selectedTime;
            document.getElementById('summaryDuration').textContent = selectedDuration + ' hour' + (selectedDuration>1?'s':'');
            document.getElementById('summaryTotal').textContent = 'SAR ' + total;
            document.getElementById('includedList').innerHTML = info.included.map(i => '<li>' + i + '</li>').join('');
            document.getElementById('confirmModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function bookFullPackage() {
            const info = companionInfo.fullpackage;
            const dateStr = selectedDate.toLocaleDateString('en-US', {weekday:'short',month:'short',day:'numeric'});
            document.getElementById('summaryCompanion').textContent = info.name;
            document.getElementById('summaryDate').textContent = dateStr;
            document.getElementById('summaryTime').textContent = 'Sunset slot';
            document.getElementById('summaryDuration').textContent = 'Full evening';
            document.getElementById('summaryTotal').textContent = 'SAR ' + info.basePrice;
            document.getElementById('includedList').innerHTML = info.included.map(i => '<li>' + i + '</li>').join('');
            document.getElementById('confirmModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() { document.getElementById('confirmModal').style.display = 'none'; document.body.style.overflow = ''; }
        function selectOccasion(el) { document.querySelectorAll('.occasion-pill').forEach(p => p.classList.remove('selected')); el.classList.add('selected'); }
        function completeReservation() { alert('Reservation complete!'); closeModal(); }

        document.addEventListener('click', e => {
            const panel = document.getElementById('calendarPanel');
            if (!e.target.closest('.calendar-dropdown') && !e.target.closest('.date-pill')) panel.classList.remove('open');
        });

        generateDatePills(); generateTimeSlots(); generateDuration(); renderCalendar();
    </script>
</body>
</html>
